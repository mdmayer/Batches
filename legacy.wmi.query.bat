@echo off
: By Mark Mayer - Generates report for specific OSs via WMI query

wmic /failfast:on /node:172.16.10.1, 172.16.10.2, 172.16.10.3, 172.16.10.4, 172.16.10.5, 172.16.10.6, 172.16.10.7, 172.16.10.8, 172.16.10.9, 172.16.10.10, 172.16.10.11, 172.16.10.12, 172.16.10.13, 172.16.10.14, 172.16.10.15, 172.16.10.16, 172.16.10.17, 172.16.10.18, 172.16.10.19, 172.16.10.20, 172.16.10.21, 172.16.10.22, 172.16.10.23, 172.16.10.24, 172.16.10.25, 172.16.10.26, 172.16.10.27, 172.16.10.28, 172.16.10.29, 172.16.10.30, 172.16.10.31, 172.16.10.32, 172.16.10.33, 172.16.10.34, 172.16.10.35, 172.16.10.36, 172.16.10.37, 172.16.10.38, 172.16.10.39, 172.16.10.40, 172.16.10.41, 172.16.10.42, 172.16.10.43, 172.16.10.44, 172.16.10.45, 172.16.10.46, 172.16.10.47, 172.16.10.48, 172.16.10.49, 172.16.10.50, 172.16.10.51, 172.16.10.52, 172.16.10.53, 172.16.10.54, 172.16.10.55, 172.16.10.56, 172.16.10.57, 172.16.10.58, 172.16.10.59, 172.16.10.60, 172.16.10.61, 172.16.10.62, 172.16.10.63, 172.16.10.64, 172.16.10.65, 172.16.10.66, 172.16.10.67, 172.16.10.68, 172.16.10.69, 172.16.10.70, 172.16.10.71, 172.16.10.72, 172.16.10.73, 172.16.10.74, 172.16.10.75, 172.16.10.76, 172.16.10.77, 172.16.10.78, 172.16.10.79, 172.16.10.80, 172.16.10.81, 172.16.10.82, 172.16.10.83, 172.16.10.84, 172.16.10.85, 172.16.10.86, 172.16.10.87, 172.16.10.88, 172.16.10.89, 172.16.10.90, 172.16.10.91, 172.16.10.92, 172.16.10.93, 172.16.10.94, 172.16.10.95, 172.16.10.96, 172.16.10.97, 172.16.10.98, 172.16.10.99, 172.16.10.100, 172.16.10.101, 172.16.10.102, 172.16.10.103, 172.16.10.104, 172.16.10.105, 172.16.10.106, 172.16.10.107, 172.16.10.108, 172.16.10.109, 172.16.10.110, 172.16.10.111, 172.16.10.112, 172.16.10.113, 172.16.10.114, 172.16.10.115, 172.16.10.116, 172.16.10.117, 172.16.10.118, 172.16.10.119, 172.16.10.120, 172.16.10.121, 172.16.10.122, 172.16.10.123, 172.16.10.124, 172.16.10.125, 172.16.10.126, 172.16.10.127, 172.16.10.128, 172.16.10.129, 172.16.10.130, 172.16.10.131, 172.16.10.132, 172.16.10.133, 172.16.10.134, 172.16.10.135, 172.16.10.136, 172.16.10.137, 172.16.10.138, 172.16.10.139, 172.16.10.140, 172.16.10.141, 172.16.10.142, 172.16.10.143, 172.16.10.144, 172.16.10.145, 172.16.10.146, 172.16.10.147, 172.16.10.148, 172.16.10.149, 172.16.10.150, 172.16.10.151, 172.16.10.152, 172.16.10.153, 172.16.10.154, 172.16.10.155, 172.16.10.156, 172.16.10.157, 172.16.10.158, 172.16.10.159, 172.16.10.160, 172.16.10.161, 172.16.10.162, 172.16.10.163, 172.16.10.164, 172.16.10.165, 172.16.10.166, 172.16.10.167, 172.16.10.168, 172.16.10.169, 172.16.10.170 path Win32_OperatingSystem WHERE "Caption Like '%%2003%%'" get Caption, Csname, Csdversion, Creationclassname /format:htable >> "DataBank 2003.html"

wmic /failfast:on /node:172.16.10.1, 172.16.10.2, 172.16.10.3, 172.16.10.4, 172.16.10.5, 172.16.10.6, 172.16.10.7, 172.16.10.8, 172.16.10.9, 172.16.10.10, 172.16.10.11, 172.16.10.12, 172.16.10.13, 172.16.10.14, 172.16.10.15, 172.16.10.16, 172.16.10.17, 172.16.10.18, 172.16.10.19, 172.16.10.20, 172.16.10.21, 172.16.10.22, 172.16.10.23, 172.16.10.24, 172.16.10.25, 172.16.10.26, 172.16.10.27, 172.16.10.28, 172.16.10.29, 172.16.10.30, 172.16.10.31, 172.16.10.32, 172.16.10.33, 172.16.10.34, 172.16.10.35, 172.16.10.36, 172.16.10.37, 172.16.10.38, 172.16.10.39, 172.16.10.40, 172.16.10.41, 172.16.10.42, 172.16.10.43, 172.16.10.44, 172.16.10.45, 172.16.10.46, 172.16.10.47, 172.16.10.48, 172.16.10.49, 172.16.10.50, 172.16.10.51, 172.16.10.52, 172.16.10.53, 172.16.10.54, 172.16.10.55, 172.16.10.56, 172.16.10.57, 172.16.10.58, 172.16.10.59, 172.16.10.60, 172.16.10.61, 172.16.10.62, 172.16.10.63, 172.16.10.64, 172.16.10.65, 172.16.10.66, 172.16.10.67, 172.16.10.68, 172.16.10.69, 172.16.10.70, 172.16.10.71, 172.16.10.72, 172.16.10.73, 172.16.10.74, 172.16.10.75, 172.16.10.76, 172.16.10.77, 172.16.10.78, 172.16.10.79, 172.16.10.80, 172.16.10.81, 172.16.10.82, 172.16.10.83, 172.16.10.84, 172.16.10.85, 172.16.10.86, 172.16.10.87, 172.16.10.88, 172.16.10.89, 172.16.10.90, 172.16.10.91, 172.16.10.92, 172.16.10.93, 172.16.10.94, 172.16.10.95, 172.16.10.96, 172.16.10.97, 172.16.10.98, 172.16.10.99, 172.16.10.100, 172.16.10.101, 172.16.10.102, 172.16.10.103, 172.16.10.104, 172.16.10.105, 172.16.10.106, 172.16.10.107, 172.16.10.108, 172.16.10.109, 172.16.10.110, 172.16.10.111, 172.16.10.112, 172.16.10.113, 172.16.10.114, 172.16.10.115, 172.16.10.116, 172.16.10.117, 172.16.10.118, 172.16.10.119, 172.16.10.120, 172.16.10.121, 172.16.10.122, 172.16.10.123, 172.16.10.124, 172.16.10.125, 172.16.10.126, 172.16.10.127, 172.16.10.128, 172.16.10.129, 172.16.10.130, 172.16.10.131, 172.16.10.132, 172.16.10.133, 172.16.10.134, 172.16.10.135, 172.16.10.136, 172.16.10.137, 172.16.10.138, 172.16.10.139, 172.16.10.140, 172.16.10.141, 172.16.10.142, 172.16.10.143, 172.16.10.144, 172.16.10.145, 172.16.10.146, 172.16.10.147, 172.16.10.148, 172.16.10.149, 172.16.10.150, 172.16.10.151, 172.16.10.152, 172.16.10.153, 172.16.10.154, 172.16.10.155, 172.16.10.156, 172.16.10.157, 172.16.10.158, 172.16.10.159, 172.16.10.160, 172.16.10.161, 172.16.10.162, 172.16.10.163, 172.16.10.164, 172.16.10.165, 172.16.10.166, 172.16.10.167, 172.16.10.168, 172.16.10.169, 172.16.10.170 path Win32_OperatingSystem WHERE "Caption='Microsoft Windows 2000 Advanced Server' OR Caption='Microsoft Windows 2000 Server' OR Caption='Microsoft Windows XP Professional'" get Caption, Csname, Csdversion, Creationclassname /format:htable >> "DataBank Legacy.html"

wmic /failfast:on /node:172.16.20.1, 172.16.20.2, 172.16.20.3, 172.16.20.4, 172.16.20.5, 172.16.20.6, 172.16.20.7, 172.16.20.8, 172.16.20.9, 172.16.20.10, 172.16.20.11, 172.16.20.12, 172.16.20.13, 172.16.20.14, 172.16.20.15, 172.16.20.16, 172.16.20.17, 172.16.20.18, 172.16.20.19, 172.16.20.20, 172.16.20.21, 172.16.20.22, 172.16.20.23, 172.16.20.24, 172.16.20.25, 172.16.20.26, 172.16.20.27, 172.16.20.28, 172.16.20.29, 172.16.20.30, 172.16.20.31, 172.16.20.32, 172.16.20.33, 172.16.20.34, 172.16.20.35, 172.16.20.36, 172.16.20.37, 172.16.20.38, 172.16.20.39, 172.16.20.40, 172.16.20.41, 172.16.20.42, 172.16.20.43, 172.16.20.44, 172.16.20.45, 172.16.20.46, 172.16.20.47, 172.16.20.48, 172.16.20.49, 172.16.20.50, 172.16.20.51, 172.16.20.52, 172.16.20.53, 172.16.20.54, 172.16.20.55, 172.16.20.56, 172.16.20.57, 172.16.20.58, 172.16.20.59, 172.16.20.60, 172.16.20.61, 172.16.20.62, 172.16.20.63, 172.16.20.64, 172.16.20.65, 172.16.20.66, 172.16.20.67, 172.16.20.68, 172.16.20.69, 172.16.20.70, 172.16.20.71, 172.16.20.72, 172.16.20.73, 172.16.20.74, 172.16.20.75, 172.16.20.76, 172.16.20.77, 172.16.20.78, 172.16.20.79, 172.16.20.80, 172.16.20.81, 172.16.20.82, 172.16.20.83, 172.16.20.84, 172.16.20.85, 172.16.20.86, 172.16.20.87, 172.16.20.88, 172.16.20.89, 172.16.20.90, 172.16.20.91, 172.16.20.92, 172.16.20.93, 172.16.20.94, 172.16.20.95, 172.16.20.96, 172.16.20.97, 172.16.20.98, 172.16.20.99, 172.16.20.100, 172.16.20.101, 172.16.20.102, 172.16.20.103, 172.16.20.104, 172.16.20.105, 172.16.20.106, 172.16.20.107, 172.16.20.108, 172.16.20.109, 172.16.20.110, 172.16.20.111, 172.16.20.112, 172.16.20.113, 172.16.20.114, 172.16.20.115, 172.16.20.116, 172.16.20.117, 172.16.20.118, 172.16.20.119, 172.16.20.120, 172.16.20.121, 172.16.20.122, 172.16.20.123, 172.16.20.124, 172.16.20.125, 172.16.20.126, 172.16.20.127, 172.16.20.128, 172.16.20.129, 172.16.20.130, 172.16.20.131, 172.16.20.132, 172.16.20.133, 172.16.20.134, 172.16.20.135, 172.16.20.136, 172.16.20.137, 172.16.20.138, 172.16.20.139, 172.16.20.140, 172.16.20.141, 172.16.20.142, 172.16.20.143, 172.16.20.144, 172.16.20.145, 172.16.20.146, 172.16.20.147, 172.16.20.148, 172.16.20.149, 172.16.20.150 path Win32_OperatingSystem WHERE "Caption Like '%%2003%%'" get Caption, Csname, Csdversion, Creationclassname /format:htable >> "Sungard 2003.html"

wmic /failfast:on /node:172.16.20.1, 172.16.20.2, 172.16.20.3, 172.16.20.4, 172.16.20.5, 172.16.20.6, 172.16.20.7, 172.16.20.8, 172.16.20.9, 172.16.20.10, 172.16.20.11, 172.16.20.12, 172.16.20.13, 172.16.20.14, 172.16.20.15, 172.16.20.16, 172.16.20.17, 172.16.20.18, 172.16.20.19, 172.16.20.20, 172.16.20.21, 172.16.20.22, 172.16.20.23, 172.16.20.24, 172.16.20.25, 172.16.20.26, 172.16.20.27, 172.16.20.28, 172.16.20.29, 172.16.20.30, 172.16.20.31, 172.16.20.32, 172.16.20.33, 172.16.20.34, 172.16.20.35, 172.16.20.36, 172.16.20.37, 172.16.20.38, 172.16.20.39, 172.16.20.40, 172.16.20.41, 172.16.20.42, 172.16.20.43, 172.16.20.44, 172.16.20.45, 172.16.20.46, 172.16.20.47, 172.16.20.48, 172.16.20.49, 172.16.20.50, 172.16.20.51, 172.16.20.52, 172.16.20.53, 172.16.20.54, 172.16.20.55, 172.16.20.56, 172.16.20.57, 172.16.20.58, 172.16.20.59, 172.16.20.60, 172.16.20.61, 172.16.20.62, 172.16.20.63, 172.16.20.64, 172.16.20.65, 172.16.20.66, 172.16.20.67, 172.16.20.68, 172.16.20.69, 172.16.20.70, 172.16.20.71, 172.16.20.72, 172.16.20.73, 172.16.20.74, 172.16.20.75, 172.16.20.76, 172.16.20.77, 172.16.20.78, 172.16.20.79, 172.16.20.80, 172.16.20.81, 172.16.20.82, 172.16.20.83, 172.16.20.84, 172.16.20.85, 172.16.20.86, 172.16.20.87, 172.16.20.88, 172.16.20.89, 172.16.20.90, 172.16.20.91, 172.16.20.92, 172.16.20.93, 172.16.20.94, 172.16.20.95, 172.16.20.96, 172.16.20.97, 172.16.20.98, 172.16.20.99, 172.16.20.100, 172.16.20.101, 172.16.20.102, 172.16.20.103, 172.16.20.104, 172.16.20.105, 172.16.20.106, 172.16.20.107, 172.16.20.108, 172.16.20.109, 172.16.20.110, 172.16.20.111, 172.16.20.112, 172.16.20.113, 172.16.20.114, 172.16.20.115, 172.16.20.116, 172.16.20.117, 172.16.20.118, 172.16.20.119, 172.16.20.120, 172.16.20.121, 172.16.20.122, 172.16.20.123, 172.16.20.124, 172.16.20.125, 172.16.20.126, 172.16.20.127, 172.16.20.128, 172.16.20.129, 172.16.20.130, 172.16.20.131, 172.16.20.132, 172.16.20.133, 172.16.20.134, 172.16.20.135, 172.16.20.136, 172.16.20.137, 172.16.20.138, 172.16.20.139, 172.16.20.140, 172.16.20.141, 172.16.20.142, 172.16.20.143, 172.16.20.144, 172.16.20.145, 172.16.20.146, 172.16.20.147, 172.16.20.148, 172.16.20.149, 172.16.20.150 path Win32_OperatingSystem WHERE "Caption='Microsoft Windows 2000 Advanced Server' OR Caption='Microsoft Windows 2000 Server' OR Caption='Microsoft Windows XP Professional'" get Caption, Csname, Csdversion, Creationclassname /format:htable >> "Sungard Legacy.html"

EOF
